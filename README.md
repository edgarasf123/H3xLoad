Incomplete addon, I decided its too big of a clusterfuck to continue. Feel free to fork.